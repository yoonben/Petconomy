<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.peco.mapper.PensionMapper">
  	<select id="mapList" resultType="com.peco.vo.PensionVO">
  	 select p_Id, Addr, openHour, ParkYN, latitude, longitude from pension where category='펜션'
  	</select>

  	<select id="pensionList" resultType="com.peco.vo.PensionVO">
  	 select * from(select t.*, rownum rn from(select p_Id, Addr, openHour, ParkYN, latitude, longitude from pension where category='펜션' order by p_id desc) t) 
	where rn between 1 and 10
  	</select>
  	<select id="getOne_P" resultType="com.peco.vo.PensionVO">
		select * from Pension where m_id=#{m_id}
	</select>
  	
  	<update id = "update_P">
		update Pension set
			p_id = #{p_id},
			pName = #{pName},
			Addr = #{Addr},
			openHour = #{openHour},
			ParkYN = #{ParkYN},
			checkYN = #{checkYN}
			where m_id = #{m_id}
	</update>
  	
  	<select id="getOne" resultType="com.peco.vo.PensionVO">
		select * from pension where p_id = #{p_id}
	</select>
	
	<select id="roomList" resultType="com.peco.vo.PensionRoomVO">
		select * from p_room where p_id = #{p_id}
	</select>
	
	<select id="reviewList" resultType="com.peco.vo.PensionReviewVO">
		select * from p_review where p_id = #{p_id}
	</select>
	
	<select id="starAvg" resultType="int">
		<!-- select coalesce(round(avg(star)), 0) from p_review where p_id = #{p_id} -->
		select round(avg(star)) from p_review where p_id = #{p_id}
	</select>	
	
  	<insert id="pensionInsert">
  	insert ignore into pension(M_ID, PNAME, ADDR, OPENHOUR, PARKYN, CHECKYN) 
  	values('M0002', #{pname}, #{addr}, #{openHour}, #{parkYN} ,'N')
  	</insert>
  </mapper>